<Window x:Class="Resource_Unpacker.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Resource_Unpacker"
        xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
        mc:Ignorable="d"
        
        Title="{Binding file.barFileName, StringFormat='{}Age of Empires III - Resource Unpacker (CC, DE) - {0}', FallbackValue='Age of Empires III - Resource Unpacker (CC, DE)'}" Height="450" Width="1077" FontFamily="Trajan Pro 3" FontSize="14" WindowStyle="SingleBorderWindow" WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <local:HighlightingDefinitionConverter  x:Key="HighlightingDefinitionConverter"/>
        <local:RunEnabledColorConverter x:Key="RunEnabledColorConverter" />
        <local:PauseEnabledColorConverter  x:Key="PauseEnabledColorConverter"/>
        <local:StopEnabledColorConverter  x:Key="StopEnabledColorConverter"/>
        <Image x:Key="hotFiles" x:Shared="False">
            <Image.Source>
                <DrawingImage >
                    <DrawingImage.Drawing>


                        <DrawingGroup>
                            <DrawingGroup.Children>
                                <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M13.6611,6.7681C13.7431,7.0121,15.1221,12.5841,10.9661,14.6621L10.1031,14.7671 5.3771,14.7671C3.9621,14.7671 2.9871,13.0721 2.7321,12.4171 2.1981,11.0651 2.1961,9.7121 2.7241,8.2781 2.8561,7.9201 3.0701,7.4661 3.3091,6.9631 3.7951,5.9371 4.5301,4.3881 4.3951,3.6681L3.7811,0.4271 6.0911,2.7821C6.8471,3.5531 7.3191,4.5001 7.6151,5.4281 7.6281,5.0391 7.5651,4.6391 7.4271,4.2271 7.0841,3.1941 6.6691,2.4821 6.6621,2.4751L5.6621,0.7681 7.6621,0.873100000000001C10.9091,2.4971,11.4231,5.4331,11.5031,6.5061L12.6611,4.7681 13.6611,6.7681" />
                                <GeometryDrawing Brush="#FFE41400" Geometry="F1M12.6572,7.127C12.6572,8.841 10.9442,10.556 10.9442,10.556 9.2282,12.272 10.9442,13.984 10.9442,13.984 14.3722,12.272 12.6572,7.127 12.6572,7.127 M9.2282,10.557C9.2282,10.557 10.9442,8.842 10.9442,7.128 10.9442,7.128 10.9442,3.699 7.5152,1.985 7.5152,1.985 10.9442,5.415 7.5152,8.841 7.5152,7.097 7.0552,4.978 5.8012,3.698 6.0712,5.125 4.5452,7.6 4.0862,8.841 3.6502,10.023 3.6332,11.123 4.0862,12.272 4.3022,12.82 5.0572,13.984 5.8012,13.984L7.5152,13.984C6.1982,13.982 4.7732,11.589 5.8012,10.556 5.4122,10.947 6.3832,12.019 6.6572,12.272 7.1532,12.724 8.4972,13.984 9.2272,13.984L10.9432,13.984C10.9442,13.984,7.5162,12.272,9.2282,10.557" />
                            </DrawingGroup.Children>
                        </DrawingGroup>

                    </DrawingImage.Drawing>
                </DrawingImage>
            </Image.Source>
        </Image>

        <Style x:Key="GridSplitterVerticalGripStyle" TargetType="{x:Type GridSplitter}">
            <Setter Property="VerticalAlignment" Value="Stretch" />
            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
            <Setter Property="Cursor" Value="SizeWE" />
            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
            <Setter Property="Background"
                    Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type GridSplitter}">
                        <Border BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Background="{TemplateBinding Background}"
                                Width="{TemplateBinding Width}">
                            <Border Height="50" Width="4" VerticalAlignment="Center"
                                    HorizontalAlignment="Center" BorderThickness="1 0"
                                    Background="White" BorderBrush="#A0A0A0">
                            </Border>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="VerticalGridSplitter" TargetType="{x:Type GridSplitter}"
                BasedOn="{StaticResource GridSplitterVerticalGripStyle}">
            <Setter Property="Width" Value="6" />
            <Setter Property="Margin" Value="15 0" />
            <Setter Property="VerticalAlignment" Value="Stretch" />
            <Setter Property="HorizontalAlignment" Value="Center" />
        </Style>
    </Window.Resources>

    <Grid >

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="675"/>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="auto"/>
        </Grid.RowDefinitions>

        <Menu x:Name="mainMenu" VerticalAlignment="Top" Grid.ColumnSpan="3" FontFamily="Trajan Pro 3" FontSize="16">
            <MenuItem Header="File">
                <MenuItem Header="Open..." Click="MenuItem_Click" >
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                            <Rectangle Width="16" Height="16">
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <DrawingGroup>
                                                <DrawingGroup.Children>
                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,5.3774L16,14.0004 14,14.0004 14,16.0004 4,16.0004 4,9.0004 3.499,9.0004C1.572,8.9984 0.00200000000000067,7.4284 0,5.5014 0,3.5704 1.57,2.0004 3.5,2.0004L4.504,2.0004 3.608,1.1034 4.711,0.000399999999999956 6.747,0.000399999999999956 8.747,2.0004 12.621,2.0004z" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M10,8L10,6.207 11.793,8z M12.207,3L9.746,3 10.246,3.5 9.746,4 11.793,4 14,6.207 14,12 13,12 13,7.792 10.207,5 8.746,5 7.746,6 9,6 9,9 12,9 12,14 6,14 6,7.745 5.728,8.018 5,7.289 5,15 5.713,15 6,15 13,15 13,13 15,13 15,5.792z" />
                                                    <GeometryDrawing Brush="#FF00539C" Geometry="F1M8.832,3.5L5.728,6.603 5.022,5.896 6.919,4 3.5,4C2.673,4 2,4.673 2,5.5 2,6.327 2.673,7 3.5,7L3.5,8C2.12,7.999 1.001,6.88 1,5.5 1,4.122 2.122,3 3.5,3L6.918,3 5.022,1.103 5.729,0.396z" />
                                                </DrawingGroup.Children>
                                            </DrawingGroup>
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Viewbox>
                    </MenuItem.Icon>
                </MenuItem>

                <MenuItem x:Name="openMenu" Header="Recent Files" ItemsSource="{Binding recentFiles}" >
                    <MenuItem.Style>
                        <Style TargetType="{x:Type MenuItem}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding recentFiles.Count}" Value="0">
                                    <Setter Property="IsEnabled" Value="False"/>
                                </DataTrigger>
                            </Style.Triggers>

                        </Style>
                    </MenuItem.Style>
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                            <Rectangle Width="16" Height="16">
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <DrawingGroup>
                                                <DrawingGroup.Children>
                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,8C16,12.418 12.418,16 8,16 7.979,16 7.96,15.997 7.939,15.997 7.919,15.997 7.9,16 7.879,16 7.817,16 7.758,15.986 7.695,15.984 7.439,15.975 7.186,15.954 6.936,15.921 3.754,15.538 1.044,13.278 0.175000000000001,10.133L0,9.5 0,9.143 0,3 0,1 3,1 3,1.68C4.133,0.795 5.491,0.252 6.935,0.0789999999999997 7.185,0.0460000000000003 7.438,0.0250000000000004 7.696,0.016 7.758,0.0140000000000002 7.817,0 7.879,0 7.9,0 7.919,0.00300000000000011 7.939,0.00300000000000011 7.96,0.00300000000000011 7.979,0 8,0 12.418,0 16,3.582 16,8" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M10.3701,10.6641L9.6301,11.3361 7.0001,8.4431 7.0001,4.0001 8.0001,4.0001 8.0001,8.0571z" />
                                                    <GeometryDrawing Brush="#FF329932" Geometry="F1M14.8799,8C14.8799,11.859 11.7389,15 7.8799,15 4.7459,15 1.9739,12.889 1.1389,9.866L2.1029,9.601C2.8179,12.19 5.1939,14 7.8799,14 11.1889,14 13.8799,11.309 13.8799,8 13.8799,4.691 11.1889,2 7.8799,2 5.7209,2 3.7609,3.174 2.7019,5L4.9999,5 4.9999,6 0.999899999999998,6 0.999899999999998,2 1.9999,2 1.9999,4.25C3.2659,2.267 5.4629,1 7.8799,1 11.7389,1 14.8799,4.14 14.8799,8" />
                                                </DrawingGroup.Children>
                                            </DrawingGroup>
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Viewbox>
                    </MenuItem.Icon>
                    <MenuItem.ItemContainerStyle>

                        <Style TargetType="MenuItem">
                            <Setter Property="Header" Value="{Binding Title}"/>
                            <Setter Property="Command" Value="{Binding OnClickCommand}"/>
                            <Setter Property="CommandParameter" Value="{Binding FileName}"/>
                            <Setter Property="Icon" Value="{StaticResource hotFiles}"/>
                        </Style>
                    </MenuItem.ItemContainerStyle>
                </MenuItem>
                <Separator/>
                <MenuItem Header="Exit" Click="MenuItem_Click_1">
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                            <Rectangle Width="16" Height="16">
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <DrawingGroup>
                                                <DrawingGroup.Children>
                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M0,0.999700000000001L0,6.9997 0,14.9997 0,15.9997 10,15.9997 10,14.9997 16,14.9997 16,0.999700000000001z" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M1,15L9,15 9,8 1,8z M15,2L15,14 10,14 10,13 14,13 14,5 2,5 2,7 1,7 1,2z" />
                                                    <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M14,5L14,13 10,13 10,7 2,7 2,5z" />
                                                    <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M8,14L6.5,14 5,12.5 3.5,14 2,14 4.25,11.75 2,9.5 3.5,9.5 5,11 6.5,9.5 8,9.5 5.75,11.75z" />
                                                </DrawingGroup.Children>
                                            </DrawingGroup>
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Viewbox>
                    </MenuItem.Icon>
                </MenuItem>
                <Separator/>
            </MenuItem>
            <MenuItem Header="Extract &amp; Convert">
                <MenuItem Header="All Files..." Click="MenuItem_Click_6">
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                            <Rectangle Width="16" Height="16">
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <DrawingGroup>
                                                <DrawingGroup.Children>
                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,12L11.681,12.003 11.341,13.366 9.752,12.193C9.575,12.063 9.366,11.994 9.147,11.994 8.843,11.994 8.559,12.129 8.367,12.364 8.062,12.736 8.062,13.275 8.365,13.648L9.619,15.185 7.716,15.751C7.16,15.916 6.583,16 6.001,16 4.623,16 3.275,15.519 2.207,14.649 0.965999999999999,13.636 0.193,12.199 0.0310000000000006,10.604 -0.129999999999999,9.009 0.339,7.448 1.353,6.206 1.552,5.963 1.771,5.743 2,5.537L2,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M4,4L6.002,4C5.802,4 5.601,4.01 5.397,4.03 4.913,4.079 4.447,4.191 4,4.348z M6.002,4L14,4 14,10 11.983,10C11.98,8.224 11.2,6.498 9.795,5.352 8.71,4.467 7.399,4 6.002,4 M14,3L4,3 4,2 14,2z M7.214,8.179C6.768,8.663 6.121,8.319 5.677,8.024 5.209,7.712 5.597,6.991 6.062,7.185 6.294,6.855 6.785,6.646 7.144,6.819 7.634,7.054 7.526,7.839 7.214,8.179 M5.077,12.138C4.703,12.167 4.277,11.943 4.21,11.589 4.118,11.108 4.767,10.725 5.193,10.747 5.801,10.778 5.897,11.434 5.918,11.919 5.94,12.431 5.186,12.579 5.077,12.138 M3.722,10.044C3.477,10.385 2.951,10.076 3.108,9.735 2.869,9.553 2.727,9.182 2.865,8.919 3.054,8.561 3.635,8.663 3.88,8.905 4.228,9.25 3.954,9.722 3.722,10.044 M8.676,6.723C7.914,6.1 6.98,5.769 6.009,5.769 5.865,5.769 5.721,5.776 5.575,5.791 4.451,5.904 3.438,6.449 2.723,7.324 2.009,8.2 1.678,9.301 1.792,10.426 1.905,11.55 2.45,12.562 3.325,13.277 4.277,14.054 5.509,14.373 6.705,14.171 6.24,13.241 6.348,12.095 7.027,11.263 7.807,10.309 9.11,10.025 10.196,10.509 10.367,9.084 9.801,7.641 8.676,6.723" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M5.1935,10.7471C5.8015,10.7781 5.8965,11.4341 5.9175,11.9191 5.9405,12.4311 5.1855,12.5791 5.0775,12.1381 4.7025,12.1671 4.2775,11.9431 4.2105,11.5891 4.1185,11.1081 4.7675,10.7251 5.1935,10.7471 M3.8795,8.9051C4.2285,9.2501 3.9545,9.7221 3.7225,10.0441 3.4775,10.3841 2.9505,10.0751 3.1075,9.7351 2.8695,9.5531 2.7275,9.1821 2.8655,8.9191 3.0535,8.5611 3.6355,8.6631 3.8795,8.9051 M7.2135,8.1791C6.7675,8.6631 6.1215,8.3191 5.6775,8.0241 5.2085,7.7121 5.5965,6.9911 6.0625,7.1851 6.2935,6.8551 6.7845,6.6461 7.1445,6.8191 7.6335,7.0531 7.5265,7.8391 7.2135,8.1791 M6.0085,5.7691C5.8655,5.7691 5.7205,5.7761 5.5755,5.7911 4.4505,5.9041 3.4385,6.4491 2.7235,7.3241 2.0085,8.2001 1.6775,9.3011 1.7915,10.4261 1.9055,11.5501 2.4505,12.5621 3.3255,13.2771 4.2765,14.0541 5.5085,14.3731 6.7045,14.1711 6.2405,13.2411 6.3485,12.0951 7.0265,11.2631 7.8075,10.3091 9.1095,10.0251 10.1955,10.5091 10.3675,9.0841 9.8005,7.6401 8.6765,6.7221 7.9135,6.1001 6.9805,5.7691 6.0085,5.7691 M6.0005,15.0001C4.8625,15.0001 3.7435,14.6111 2.8385,13.8731 1.8045,13.0291 1.1605,11.8321 1.0255,10.5031 0.891500000000001,9.1741 1.2825,7.8721 2.1275,6.8381 2.9725,5.8031 4.1685,5.1591 5.4975,5.0251 6.8235,4.8941 8.1265,5.2811 9.1625,6.1261 10.6525,7.3421 11.3135,9.3361 10.8485,11.2071L10.7095,11.7651 10.2475,11.4241C9.4235,10.8171 8.2705,10.9581 7.6225,11.7501 7.0475,12.4541 7.0465,13.4751 7.6205,14.1791L7.9855,14.6271 7.4315,14.7911C6.9615,14.9321,6.4795,15.0001,6.0005,15.0001 M14.0005,3.0001L4.0005,3.0001 4.0005,2.0001 14.0005,2.0001z M3.0005,1.0001L3.0005,4.8081C3.3175,4.6241,3.6525,4.4711,4.0005,4.3491L4.0005,4.0001 14.0005,4.0001 14.0005,10.0001 12.0005,10.0001 12.0005,11.0041C12.0005,11.0041,15.0005,10.9451,15.0005,11.0001L15.0005,1.0001z" />
                                                </DrawingGroup.Children>
                                            </DrawingGroup>
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Viewbox>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Selected..." Click="MenuItem_Click_2">
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                            <Rectangle Width="16" Height="16">
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <DrawingGroup>
                                                <DrawingGroup.Children>
                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,0L16,12 15.949,12C15.697,14.244 13.81,16 11.5,16 10.638,16 9.841,15.744 9.156,15.323L7.716,15.751C7.16,15.916 6.583,16 6.001,16 4.623,16 3.275,15.519 2.207,14.649 0.965999999999999,13.636 0.193,12.199 0.0310000000000006,10.604 -0.129999999999999,9.009 0.339,7.448 1.353,6.206 1.552,5.963 1.771,5.743 2,5.537L2,0z" />
                                                    <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M4,4L6.003,4C5.803,4 5.602,4.01 5.397,4.03 4.913,4.079 4.447,4.191 4,4.348z M6.003,4L14,4 14,7.785C13.259,7.282 12.396,7 11.5,7 11.404,7 11.312,7.017 11.218,7.023L10.987,6.676C10.651,6.168 10.25,5.723 9.795,5.352 8.71,4.467 7.399,4 6.003,4 M14,3L4,3 4,2 14,2z M7.214,8.179C6.768,8.663 6.121,8.319 5.677,8.024 5.209,7.712 5.597,6.991 6.062,7.185 6.294,6.855 6.785,6.646 7.144,6.819 7.634,7.054 7.526,7.839 7.214,8.179 M5.077,12.138C4.703,12.167 4.277,11.943 4.21,11.589 4.118,11.108 4.767,10.725 5.193,10.747 5.801,10.778 5.897,11.434 5.918,11.919 5.94,12.431 5.186,12.579 5.077,12.138 M3.722,10.044C3.477,10.385 2.951,10.076 3.108,9.735 2.869,9.553 2.727,9.182 2.865,8.919 3.054,8.561 3.635,8.663 3.88,8.905 4.228,9.25 3.954,9.722 3.722,10.044 M8.676,6.723C7.914,6.1 6.98,5.769 6.009,5.769 5.865,5.769 5.721,5.776 5.575,5.791 4.451,5.904 3.438,6.449 2.723,7.324 2.009,8.2 1.678,9.301 1.792,10.426 1.905,11.55 2.45,12.562 3.325,13.277 4.277,14.054 5.509,14.373 6.705,14.171 6.241,13.243 6.349,12.1 7.023,11.269 7.108,9.638 8.059,8.246 9.43,7.528 9.217,7.231 8.966,6.959 8.676,6.723" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M7.2172,12.8095C7.0892,12.3925 7.0002,11.9585 7.0002,11.4995 7.0002,11.4215 7.0192,11.3475 7.0232,11.2695 6.3482,12.1005 6.2412,13.2435 6.7042,14.1715 5.5092,14.3735 4.2762,14.0535 3.3252,13.2775 2.4502,12.5625 1.9052,11.5495 1.7912,10.4255 1.6782,9.3015 2.0092,8.1995 2.7232,7.3245 3.4382,6.4495 4.4512,5.9045 5.5752,5.7905 5.7202,5.7755 5.8652,5.7685 6.0092,5.7685 6.9802,5.7685 7.9142,6.0995 8.6762,6.7225 8.9662,6.9595 9.2172,7.2315 9.4292,7.5285 9.6612,7.4075 9.9012,7.3085 10.1542,7.2285 9.8832,6.8195 9.5532,6.4445 9.1622,6.1265 8.1262,5.2815 6.8242,4.8935 5.4982,5.0245 4.1692,5.1595 2.9722,5.8035 2.1272,6.8375 1.2822,7.8725 0.8912,9.1745 1.0262,10.5025 1.1602,11.8315 1.8042,13.0295 2.8392,13.8735 3.7432,14.6115 4.8622,14.9995 6.0012,14.9995 6.4792,14.9995 6.9612,14.9315 7.4322,14.7915L7.9852,14.6275 7.6202,14.1795C7.2982,13.7845,7.1772,13.2925,7.2172,12.8095 M14.0002,1.9995L4.0002,1.9995 4.0002,2.9995 14.0002,2.9995z M14.0002,3.9995L4.0002,3.9995 4.0002,4.3485C3.6522,4.4715,3.3182,4.6245,3.0002,4.8085L3.0002,0.999499999999999 15.0002,0.999499999999999 15.0002,8.7185C14.7602,8.4025,14.5692,8.2235,14.5692,8.2235L14.5382,8.1955C14.3702,8.0415,14.1862,7.9115,14.0002,7.7845z M4.2102,11.5895C4.2772,11.9435 4.7032,12.1675 5.0772,12.1375 5.1862,12.5785 5.9402,12.4315 5.9182,11.9195 5.8962,11.4345 5.8012,10.7785 5.1932,10.7475 4.7672,10.7255 4.1182,11.1075 4.2102,11.5895 M2.8652,8.9185C2.7272,9.1815 2.8692,9.5535 3.1082,9.7345 2.9502,10.0755 3.4772,10.3845 3.7222,10.0445 3.9542,9.7215 4.2282,9.2505 3.8802,8.9045 3.6352,8.6625 3.0532,8.5605 2.8652,8.9185 M7.2132,8.1785C6.7682,8.6635 6.1212,8.3195 5.6772,8.0245 5.2082,7.7125 5.5972,6.9905 6.0622,7.1845 6.2942,6.8555 6.7842,6.6465 7.1442,6.8185 7.6342,7.0535 7.5262,7.8395 7.2132,8.1785" />
                                                    <GeometryDrawing Brush="#FF329932" Geometry="F1M15,11.5C15,13.433 13.433,15 11.5,15 9.567,15 8,13.433 8,11.5 8,9.567 9.567,8 11.5,8 12.414,8 13.238,8.358 13.861,8.932L10.5,12.293 9.354,11.146 8.646,11.854 10.5,13.707 14.494,9.713C14.32,9.422,15,10.48,15,11.5" />
                                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1M8.6635,11.8664L9.3595,11.1544 10.4855,12.2644 13.8315,8.9344C13.8315,8.9344,14.3955,9.5474,14.4615,9.6964L10.4855,13.6724z" />
                                                </DrawingGroup.Children>
                                            </DrawingGroup>
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Viewbox>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Help">
                <MenuItem Header="Github Page" Click="MenuItem_Click_4">
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                            <Rectangle Width="16" Height="16">
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <DrawingGroup>
                                                <DrawingGroup.Children>
                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,8C16,12.418 12.418,16 8,16 3.582,16 0,12.418 0,8 0,3.582 3.582,0 8,0 12.418,0 16,3.582 16,8" />
                                                    <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M13.5078,9.6475C12.4668,10.0395 11.5158,10.2665 10.6218,10.3815 10.3508,11.3605 9.9298,12.4285 9.3838,13.5755 11.3578,13.0865 12.9298,11.5845 13.5078,9.6475 M6.2118,13.4625C5.7728,12.3855 5.4368,11.3165 5.2308,10.2695 4.1978,10.1035 3.2838,9.8695 2.4868,9.6255 3.0208,11.4385 4.4218,12.8765 6.2118,13.4625 M2.2708,8.4035C3.0478,8.6675 3.9778,8.9355 5.0538,9.1305 4.9888,8.5775 4.9488,8.0295 4.9548,7.4945 4.9598,7.0565 4.9898,6.6415 5.0318,6.2365 4.1808,6.0905 3.4178,5.8995 2.7328,5.6975 2.4238,6.4035 2.2498,7.1805 2.2498,8.0005 2.2498,8.1365 2.2608,8.2695 2.2708,8.4035 M3.2818,4.7175C3.8608,4.8805 4.4928,5.0335 5.1848,5.1535 5.3618,4.1995 5.6268,3.3685 5.9168,2.6455 4.8458,3.0625 3.9298,3.7885 3.2818,4.7175 M7.2678,2.3015C6.8848,3.0955 6.4338,4.0945 6.1998,5.3105 6.7588,5.3735 7.4008,5.4145 7.9998,5.4205 8.5708,5.4255 9.1288,5.4205 9.6998,5.3815 9.4228,4.1205 8.9558,3.0855 8.4878,2.2745 8.3268,2.2615 8.1648,2.2505 7.9998,2.2505 7.7508,2.2505 7.5078,2.2715 7.2678,2.3015 M9.6998,9.3755C9.8408,8.7085 9.9608,8.0835 9.9548,7.5055 9.9508,7.1445 9.9228,6.7985 9.8848,6.4595 9.3798,6.4985 8.8878,6.5135 8.3998,6.5135 8.2648,6.5135 8.1348,6.5115 7.9998,6.5105 7.3488,6.5035 6.7148,6.4595 6.1118,6.3905 6.0758,6.7505 6.0488,7.1195 6.0448,7.5055 6.0388,8.0885 6.0158,8.6405 6.0998,9.2505 6.6898,9.3195 7.3638,9.4145 7.9998,9.4205 8.5818,9.4235 9.1158,9.4165 9.6998,9.3755 M8.0988,13.7455C8.6928,12.5625 9.1458,11.4765 9.4508,10.4855 9.0968,10.5025 8.7448,10.5125 8.3978,10.5125 8.2628,10.5125 8.1288,10.5125 7.9938,10.5105 7.4348,10.5045 6.8918,10.4705 6.3678,10.4185 6.6088,11.5005 6.9928,12.6085 7.4958,13.7245 7.6618,13.7395 7.8298,13.7505 7.9998,13.7505 8.0328,13.7505 8.0658,13.7465 8.0988,13.7455 M9.8808,2.5715C10.2468,3.3365 10.5838,4.2245 10.7978,5.2555 11.4148,5.1605 12.0628,4.9965 12.7488,4.7595 12.0598,3.7515 11.0568,2.9785 9.8808,2.5715 M10.9688,6.3375C11.6958,6.2245 12.4628,6.0305 13.2848,5.7345 13.5838,6.4295 13.7498,7.1955 13.7498,8.0005 13.7498,8.1265 13.7388,8.2505 13.7318,8.3745 12.6938,8.8265 11.7598,9.0955 10.8838,9.2375 10.9938,8.6255 11.0508,8.0435 11.0448,7.4945 11.0408,7.0935 11.0098,6.7115 10.9688,6.3375" />
                                                    <GeometryDrawing Brush="#FF424242" Geometry="F1M9.3838,13.5752C9.9298,12.4292 10.3508,11.3602 10.6218,10.3822 11.5158,10.2662 12.4668,10.0392 13.5078,9.6472 12.9298,11.5842 11.3578,13.0872 9.3838,13.5752 M2.4868,9.6252C3.2838,9.8692 4.1978,10.1032 5.2308,10.2692 5.4368,11.3162 5.7728,12.3862 6.2118,13.4632 4.4218,12.8772 3.0208,11.4382 2.4868,9.6252 M2.2498,8.0002C2.2498,7.1802 2.4238,6.4032 2.7328,5.6972 3.4178,5.8992 4.1808,6.0912 5.0318,6.2362 4.9898,6.6412 4.9598,7.0562 4.9548,7.4942 4.9488,8.0292 4.9888,8.5772 5.0538,9.1312 3.9778,8.9352 3.0478,8.6672 2.2708,8.4032 2.2608,8.2692 2.2498,8.1372 2.2498,8.0002 M5.9168,2.6452C5.6268,3.3682 5.3618,4.1992 5.1848,5.1532 4.4928,5.0332 3.8608,4.8812 3.2818,4.7182 3.9298,3.7882 4.8458,3.0622 5.9168,2.6452 M7.9998,2.2502C8.1648,2.2502 8.3268,2.2612 8.4878,2.2742 8.9558,3.0862 9.4318,4.1202 9.7088,5.3822 9.1378,5.4212 8.5758,5.4262 8.0058,5.4212 7.4058,5.4142 6.8248,5.3732 6.2668,5.3102 6.4998,4.0952 6.8848,3.0962 7.2678,2.3022 7.5078,2.2712 7.7508,2.2502 7.9998,2.2502 M8.0058,9.4212C7.3698,9.4142 6.7578,9.3672 6.1678,9.2982 6.0838,8.6882 6.0388,8.0892 6.0448,7.5062 6.0488,7.1192 6.0758,6.7502 6.1128,6.3902 6.7148,6.4592 7.3428,6.5042 7.9938,6.5112 8.1288,6.5122 8.2628,6.5132 8.3978,6.5132 8.8858,6.5132 9.3798,6.4982 9.8848,6.4592 9.9228,6.7992 9.9508,7.1442 9.9548,7.5062 9.9608,8.0832 9.8868,8.7082 9.7458,9.3752 9.1618,9.4162 8.5878,9.4242 8.0058,9.4212 M7.9998,13.7502C7.8298,13.7502 7.6618,13.7392 7.4958,13.7242 6.9928,12.6082 6.6088,11.5002 6.3678,10.4192 6.8918,10.4712 7.4348,10.5052 7.9938,10.5112 8.1288,10.5122 8.2628,10.5122 8.3978,10.5122 8.7448,10.5122 9.0968,10.5032 9.4508,10.4852 9.1458,11.4762 8.6928,12.5622 8.0988,13.7452 8.0658,13.7462 8.0328,13.7502 7.9998,13.7502 M12.7488,4.7602C12.0628,4.9962 11.4148,5.1602 10.7978,5.2562 10.5838,4.2242 10.2468,3.3372 9.8808,2.5712 11.0568,2.9782 12.0598,3.7512 12.7488,4.7602 M10.9688,6.3382C11.6958,6.2242 12.4628,6.0302 13.2848,5.7342 13.5838,6.4292 13.7498,7.1952 13.7498,8.0002 13.7498,8.1262 13.7388,8.2502 13.7318,8.3742 12.6938,8.8262 11.7598,9.0962 10.8838,9.2372 10.9938,8.6252 11.0508,8.0432 11.0448,7.4942 11.0408,7.0942 11.0098,6.7122 10.9688,6.3382 M14.9998,8.0002C14.9998,7.9202 14.9898,7.8432 14.9878,7.7632 14.8628,4.0082 11.7858,1.0002 7.9998,1.0002 4.1338,1.0002 0.9998,4.1342 0.9998,8.0002 0.9998,8.2042 1.0118,8.4052 1.0298,8.6032 1.0458,8.7832 1.0708,8.9612 1.1008,9.1362 1.1018,9.1412 1.1018,9.1472 1.1028,9.1532 1.5918,12.0962 3.9088,14.4112 6.8528,14.8982L6.8728,14.9012C7.0468,14.9292 7.2218,14.9542 7.3998,14.9702 7.5978,14.9882 7.7968,15.0002 7.9998,15.0002 8.2318,15.0002 8.4598,14.9872 8.6848,14.9662 12.2298,14.6212 14.9998,11.6352 14.9998,8.0002" />
                                                </DrawingGroup.Children>
                                            </DrawingGroup>
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Viewbox>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="About" Click="MenuItem_Click_3">
                    <MenuItem.Icon>
                        <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                            <Rectangle Width="16" Height="16">
                                <Rectangle.Fill>
                                    <DrawingBrush>
                                        <DrawingBrush.Drawing>
                                            <DrawingGroup>
                                                <DrawingGroup.Children>
                                                    <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                    <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M0,8C0,3.582 3.582,0 8,0 12.418,0 16,3.582 16,8 16,12.418 12.418,16 8,16 3.582,16 0,12.418 0,8" />
                                                    <GeometryDrawing Brush="#FF1AA1E2" Geometry="F1M11,7C11,8.104,10.102,9,9,9L9,10 7,10 7,9C7,7.896,7.897,7,9,7L9,5.203C8.841,5.115 8.495,5 8,5 7.505,5 7.159,5.115 7,5.203L7,6 5,6 5,5C5,3.841 6.262,3 8,3 9.738,3 11,3.841 11,5z M9,13L7,13 7,11 9,11z M8,1C4.134,1 1,4.134 1,8 1,11.865 4.134,15 8,15 11.866,15 15,11.865 15,8 15,4.134 11.866,1 8,1" />
                                                    <GeometryDrawing Brush="#FFFFFFFF" Geometry="F1M9,11L7,11 7,13 9,13z M9,10L7,10 7,9C7,7.896,7.897,7,9,7L9,5.203C8.841,5.115 8.495,5 8,5 7.505,5 7.159,5.115 7,5.203L7,6 5,6 5,5C5,3.841 6.262,3 8,3 9.738,3 11,3.841 11,5L11,7C11,8.104,10.102,9,9,9z" />
                                                </DrawingGroup.Children>
                                            </DrawingGroup>
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </Rectangle.Fill>
                            </Rectangle>
                        </Viewbox>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>

        </Menu>

        <Grid Grid.Column="2" Grid.Row="1" Grid.RowSpan="2" Margin="0,0,15,15">
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition />
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0" ToolTip="{Binding ElementName=files, Path=SelectedItem.FileName}" Text="{Binding ElementName=files, Path=SelectedItem.fileNameWithoutPath, StringFormat='File Name: {0}'}" FontSize="14" TextTrimming="CharacterEllipsis"/>
            <TextBlock Grid.Row="1" Text="{Binding ElementName=files, Path=SelectedItem.fileFormat, StringFormat='File Format: {0}'}" FontSize="14"/>
            <TextBlock Grid.Row="2" Text="{Binding file.PreviewDdt.DdtInfo, StringFormat='Image Format: {0}'}" FontSize="14"/>
            <Grid Visibility="Collapsed"  x:Name="ImageViewer" Grid.Row="3">
            <ScrollViewer  HorizontalScrollBarVisibility="Visible" VirtualizingPanel.ScrollUnit="Pixel" Background="White" >


                    <Image RenderOptions.BitmapScalingMode="HighQuality" x:Name="ImagePreview"  HorizontalAlignment="Left" VerticalAlignment="Top" RenderTransformOrigin="0.5,0.5"  MouseWheel="ImageViewer_MouseWheel">
                    <Image.LayoutTransform>
                        <TransformGroup>
                            <ScaleTransform/>

                        </TransformGroup>
                    </Image.LayoutTransform>
                </Image>

                    
                
            </ScrollViewer>
            <TextBlock Padding="2,4,2,0" TextAlignment="Center" Margin="25" Text="{Binding ZoomValue, StringFormat='Current Zoom: {0}%'}" HorizontalAlignment="Right" VerticalAlignment="Bottom" Background="#99FFFFFF" FlowDirection="RightToLeft" MouseDown="TextBlock_MouseDown"/>
        </Grid>
        <avalonEdit:TextEditor
                VirtualizingPanel.ScrollUnit="Pixel"
  
Grid.Row="3"
    x:Name="XMLViewer"

    FontFamily="Consolas"
    SyntaxHighlighting="{Binding file.Preview.SyntaxHighlighting, Converter={StaticResource HighlightingDefinitionConverter}}"

    FontSize="10pt" ShowLineNumbers="True" IsReadOnly="True" Visibility="Collapsed">

            </avalonEdit:TextEditor>
            
        </Grid>

        <ListView SelectedIndex="0" Grid.Row="1" ItemsSource="{Binding file.SourceCollection}" AlternationCount="2" Name="files" ScrollViewer.HorizontalScrollBarVisibility="Visible" ScrollViewer.VerticalScrollBarVisibility="Visible" VirtualizingPanel.ScrollUnit="Pixel" SelectionChanged="files_SelectionChanged">
            <ListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="Margin" Value="0"/>
                    <Setter Property="FontFamily" Value="Consolas"/>
                    <Setter Property="FontSize" Value="10pt"/>


                    <Style.Triggers>
                        <MultiDataTrigger >
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=(ItemsControl.AlternationIndex)}" Value="0"/>
                                <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="False"/>
                                <Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource Self}}" Value="False"/>

                            </MultiDataTrigger.Conditions>
                            <MultiDataTrigger.Setters>
                                <Setter Property="Background" Value="#0B000000" />
                            </MultiDataTrigger.Setters>


                        </MultiDataTrigger>

                    </Style.Triggers>
                </Style>
            </ListView.ItemContainerStyle>
            <ListView.View>
                <GridView AllowsColumnReorder="False">
                    <GridViewColumn Width="50">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Rectangle Width="18" Height="18" x:Name="myImage"/>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding isCompressed}" Value="True">
                                        <Setter TargetName="myImage" Property="Fill">
                                            <Setter.Value>

                                                <DrawingBrush>
                                                    <DrawingBrush.Drawing>
                                                        <DrawingGroup>
                                                            <DrawingGroup.Children>
                                                                <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M0,0L16,0 16,16 0,16z" />
                                                                <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M1.5,1L9.61,1 10.61,3 13.496,3C14.323,3,14.996,3.673,14.996,4.5L14.996,12.5C14.996,13.327,14.323,14,13.496,14L1.5,14C0.673,14,0,13.327,0,12.5L0,2.5C0,1.673,0.673,1,1.5,1" />
                                                                <GeometryDrawing Brush="#FFDCB67A" Geometry="F1M2,3L8.374,3 8.874,4 2,4z M13.496,4L10,4 9.992,4 8.992,2 1.5,2C1.225,2,1,2.224,1,2.5L1,12.5C1,12.776,1.225,13,1.5,13L13.496,13C13.773,13,13.996,12.776,13.996,12.5L13.996,4.5C13.996,4.224,13.773,4,13.496,4" />
                                                                <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M4,12L3,12 3,13 4,13z M5,11L4,11 4,12 5,12z M5,9L4,9 4,10 5,10z M4,10L3,10 3,11 4,11z M4,8L3,8 3,9 4,9z M5,7L4,7 4,8 5,8z M5,4L3,4 3,6 5,6z M2,3L8.374,3 8.874,4 2,4z" />
                                                                <GeometryDrawing Brush="#FF424242" Geometry="F1M5,4L5,6 3,6 3,4 2,4 2,13 3,13 3,12 4,12 4,11 3,11 3,10 4,10 4,9 3,9 3,8 4,8 4,7 5,7 5,8 4,8 4,9 5,9 5,10 4,10 4,11 5,11 5,12 4,12 4,13 6,13 6,4z M5,4L3,4 3,3 5,3z" />
                                                            </DrawingGroup.Children>
                                                        </DrawingGroup>
                                                    </DrawingBrush.Drawing>
                                                </DrawingBrush>

                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding isCompressed}" Value="False">
                                        <Setter TargetName="myImage" Property="Fill" Value="Transparent"/>
                                    </DataTrigger>
                                </DataTemplate.Triggers>


                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                        <GridViewColumn.Header>
                            <GridViewColumnHeader  Tag="isCompressed" Click="files_Click" >

                                <Viewbox  Margin="1,0" Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                    <Rectangle Width="16" Height="16">
                                        <Rectangle.Fill>
                                            <DrawingBrush>
                                                <DrawingBrush.Drawing>
                                                    <DrawingGroup>
                                                        <DrawingGroup.Children>
                                                            <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M0,0L16,0 16,16 0,16z" />
                                                            <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M1.5,1L9.61,1 10.61,3 13.496,3C14.323,3,14.996,3.673,14.996,4.5L14.996,12.5C14.996,13.327,14.323,14,13.496,14L1.5,14C0.673,14,0,13.327,0,12.5L0,2.5C0,1.673,0.673,1,1.5,1" />
                                                            <GeometryDrawing Brush="#FFDCB67A" Geometry="F1M2,3L8.374,3 8.874,4 2,4z M13.496,4L10,4 9.992,4 8.992,2 1.5,2C1.225,2,1,2.224,1,2.5L1,12.5C1,12.776,1.225,13,1.5,13L13.496,13C13.773,13,13.996,12.776,13.996,12.5L13.996,4.5C13.996,4.224,13.773,4,13.496,4" />
                                                            <GeometryDrawing Brush="#FFEFEFF0" Geometry="F1M4,12L3,12 3,13 4,13z M5,11L4,11 4,12 5,12z M5,9L4,9 4,10 5,10z M4,10L3,10 3,11 4,11z M4,8L3,8 3,9 4,9z M5,7L4,7 4,8 5,8z M5,4L3,4 3,6 5,6z M2,3L8.374,3 8.874,4 2,4z" />
                                                            <GeometryDrawing Brush="#FF424242" Geometry="F1M5,4L5,6 3,6 3,4 2,4 2,13 3,13 3,12 4,12 4,11 3,11 3,10 4,10 4,9 3,9 3,8 4,8 4,7 5,7 5,8 4,8 4,9 5,9 5,10 4,10 4,11 5,11 5,12 4,12 4,13 6,13 6,4z M5,4L3,4 3,3 5,3z" />
                                                        </DrawingGroup.Children>
                                                    </DrawingGroup>
                                                </DrawingBrush.Drawing>
                                            </DrawingBrush>
                                        </Rectangle.Fill>
                                    </Rectangle>
                                </Viewbox>
                            </GridViewColumnHeader>
                        </GridViewColumn.Header>
                    </GridViewColumn>
                    <GridViewColumn Width="250">
                        <GridViewColumn.Header>
                            <GridViewColumnHeader  Tag="FileName" Content="File Name" Click="files_Click"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Path=FileName}" ToolTip="{Binding Path=FileName}" TextTrimming="CharacterEllipsis"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Width="160">
                        <GridViewColumn.Header>
                            <GridViewColumnHeader   Tag="FileSize2" Content="File Size (bytes)" Click="files_Click" />
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock TextAlignment="Right" Text="{Binding Path=FileSize2, StringFormat=N0}" TextTrimming="CharacterEllipsis"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn Width="190">
                        <GridViewColumn.Header>
                            <GridViewColumnHeader  Tag="lastModifiedDate" Content="Last Modified date" Click="files_Click"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock  Text="{Binding Path=lastModifiedDate, StringFormat='yyyy-MM-dd HH:mm:ss.ms', FallbackValue='Unknown'}" TextTrimming="CharacterEllipsis"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                </GridView>
            </ListView.View>
        </ListView>
        <GridSplitter Style="{StaticResource VerticalGridSplitter}" Grid.Row="1" Grid.RowSpan="2" Grid.Column="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"/>
        <DockPanel Grid.Row="2" Margin="0,15">
            <TextBlock Text=" Search File: " Height="16" FontFamily="Trajan Pro 3" FontSize="16" VerticalAlignment="Center" />
            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" Margin="5,0">
                <Rectangle Width="16" Height="16">
                    <Rectangle.Fill>
                        <DrawingBrush>
                            <DrawingBrush.Drawing>
                                <DrawingGroup>
                                    <DrawingGroup.Children>
                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M16,5.8335C16,9.0495 13.384,11.6665 10.167,11.6665 9.136,11.6665 8.144,11.3925 7.254,10.8675L2.561,15.5605C2.277,15.8435 1.9,16.0005 1.5,16.0005 1.1,16.0005 0.723000000000001,15.8435 0.439,15.5605 -0.146000000000001,14.9755 -0.146000000000001,14.0245 0.439,13.4395L5.133,8.7445C4.608,7.8555 4.333,6.8635 4.333,5.8335 4.333,2.6165 6.95,0.000500000000000611 10.167,0.000500000000000611 13.384,0.000500000000000611 16,2.6165 16,5.8335" />
                                        <GeometryDrawing Brush="#FFF0EFF1" Geometry="F1M14,5.8335C14,7.9475 12.28,9.6665 10.167,9.6665 8.053,9.6665 6.333,7.9475 6.333,5.8335 6.333,3.7195 8.053,2.0005 10.167,2.0005 12.28,2.0005 14,3.7195 14,5.8335" />
                                        <GeometryDrawing Brush="#FF424242" Geometry="F1M10.167,9.667C8.053,9.667 6.334,7.947 6.334,5.834 6.334,3.72 8.053,2 10.167,2 12.28,2 14,3.72 14,5.834 14,7.947 12.28,9.667 10.167,9.667 M10.167,1C7.502,1 5.334,3.168 5.334,5.834 5.334,6.985 5.755,8.03 6.431,8.862L1.147,14.146C0.951000000000001,14.342 0.951000000000001,14.658 1.147,14.854 1.244,14.951 1.372,15 1.5,15 1.628,15 1.756,14.951 1.854,14.854L7.138,9.569C7.969,10.245 9.015,10.667 10.167,10.667 12.832,10.667 15,8.499 15,5.834 15,3.168 12.832,1 10.167,1" />
                                    </DrawingGroup.Children>
                                </DrawingGroup>
                            </DrawingBrush.Drawing>
                        </DrawingBrush>
                    </Rectangle.Fill>
                </Rectangle>
            </Viewbox>
            <TextBox   Text="{Binding file.FilterText, UpdateSourceTrigger=PropertyChanged}" FontFamily="Trajan Pro 3" FontSize="16"/>
        </DockPanel>
        <StatusBar Grid.Row="3" Grid.ColumnSpan="3" FontFamily="Trajan Pro 3" FontSize="16">
            <TextBlock Padding="2,0">
                <TextBlock.Text>
                    <MultiBinding StringFormat="Selected files: {0:N0} / {1:N0} ({2:N0} bytes)">
                        <Binding Path="SelectedItems.Count" ElementName="files" />
                        <Binding Path="Items.Count" ElementName="files" />
                        <Binding Path="SelectedSize" />
                    </MultiBinding>
                </TextBlock.Text>
            </TextBlock>

            <StatusBarItem HorizontalAlignment="Right" >
                <StackPanel Orientation="Horizontal">
                    <Button IsEnabled="False" Height="20" Width="20" Padding="0" Margin="6,3" x:Name="bRun" HorizontalAlignment="Center" VerticalAlignment="Center" Click="bRun_Click">
                        <Button.Content>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M2.9997,-0.000199999999999534L2.9997,15.9998 13.6677,7.9998z" />
                                                        <GeometryDrawing Brush="{Binding ElementName=bRun, Path=IsEnabled, Converter={StaticResource RunEnabledColorConverter}}" Geometry="F1M4,2L4,14 12,8z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </Button.Content>
                    </Button>
                    <Button IsEnabled="False" Height="20" Width="20" Padding="0" Margin="0" x:Name="bPause" Click="bPause_Click">
                        <Button.Content>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" VerticalAlignment="Center" HorizontalAlignment="Center">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00f6f6f6" Geometry="M16,0V16H0V0Z" />
                                                        <GeometryDrawing Brush="#FFf6f6f6" Geometry="M13,2V13H3V2Z" />
                                                        <GeometryDrawing Brush="{Binding ElementName=bPause, Path=IsEnabled, Converter={StaticResource PauseEnabledColorConverter}}" Geometry="M4,3H7v9H4ZM9,3v9h3V3Z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>

                        </Button.Content>
                    </Button>
                    <Button IsEnabled="False" Height="20" Width="20" Padding="0" Margin="6,3" x:Name="bStop" HorizontalAlignment="Center" VerticalAlignment="Center" Click="bStop_Click">
                        <Button.Content>
                            <Viewbox Width="16" Height="16" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation">
                                <Rectangle Width="16" Height="16">
                                    <Rectangle.Fill>
                                        <DrawingBrush>
                                            <DrawingBrush.Drawing>
                                                <DrawingGroup>
                                                    <DrawingGroup.Children>
                                                        <GeometryDrawing Brush="#00FFFFFF" Geometry="F1M16,16L0,16 0,0 16,0z" />
                                                        <GeometryDrawing Brush="#FFF6F6F6" Geometry="F1M13,13L3,13 3,3 13,3z" />
                                                        <GeometryDrawing Brush="{Binding ElementName=bStop, Path=IsEnabled, Converter={StaticResource StopEnabledColorConverter}}" Geometry="F1M12,12L4,12 4,4 12,4z" />
                                                    </DrawingGroup.Children>
                                                </DrawingGroup>
                                            </DrawingBrush.Drawing>
                                        </DrawingBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                            </Viewbox>
                        </Button.Content>
                    </Button>

                    <Grid>
                        <ProgressBar x:Name="progressBar" Width="300" Height="16" VerticalAlignment="Center" Value="{Binding file.CurrentProgress, FallbackValue=0}" Maximum="{Binding file.MaximumProgress, FallbackValue=100}"/>
                        <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Opacity="{Binding ElementName=progressBar, Path=Value}" FontSize="14">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="{}{0:N0} / {1:N0} bytes">
                                    <Binding Path="Value" ElementName="progressBar" />
                                    <Binding Path="Maximum" ElementName="progressBar" />
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                    </Grid>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>

